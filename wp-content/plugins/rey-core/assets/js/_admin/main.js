!function(e){"use strict";e(".js-rey-copy-code").on("click",(function(t){t.preventDefault();var n=e(t.currentTarget),i=(e(n).text(),e(n).next("pre").text()),r=e("<input>");e("body").append(r),r.val(i).select(),document.execCommand("copy"),r.remove(),n.closest(".rey-codeBlock").addClass("is-copied")})),!_.isUndefined(reyCoreAdmin.back_btn_text)&&_.isUndefined(reyCoreAdmin.back_btn_url)&&e(".post-type-rey-global-sections.post-php a.page-title-action").after((function(){return'<a class="rey-gs-back-button" href="'+reyCoreAdmin.back_btn_url+'">'+reyCoreAdmin.back_btn_text+"</a>"}));var t,n,i=!1;window.onbeforeunload=function(){if(i)return"Import is in progress!"},e(".js-rey-refresh-demos").on("click",(function(t){t.preventDefault();var n=e(this);n.addClass("--loading").text(reyCoreAdmin.strings.refreshing_btn_text),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:"rey_refresh_demos",security:reyCoreAdmin.ajax_nonce},success:function(e){e&&1==e.success&&(n.text(reyCoreAdmin.strings.reloading),setTimeout((function(){location.reload()}),1e3))},error:function(e,t,i){n.removeClass("--loading").text(reyCoreAdmin.strings.refresh_demos_error),console.error(e),console.error(t),console.error(i)}})})),e(document).on("ocdiImportComplete",(function(){var t=new Audio(reyCoreAdmin.sound_effect);t.oncanplay=function(){t.play()},e(".js-ocdi-ajax-response").length&&e("html, body").animate({scrollTop:e(".js-ocdi-ajax-response").offset.top})})),rey.frontend.inView({target:".__admin-lazy-img",once:!0,cb:function(e){e.setAttribute("src",e.getAttribute("data-src")),e.classList.add("--loaded")}}),e(document).on("ocdiImportComplete",(function(t){var n=e(".js-ocdi-ajax-response");n.append('<div class="notice notice-success"><p>'+reyCoreAdmin.ocdi_strings.visit_site+"</p></div>"),i=!1,e("body").removeClass("rey-is-importing"),document.title=reyCoreAdmin.ocdi_strings.title_done,e(".notice.notice-warning p",n).each((function(t,i){-1!=i.textContent.toLowerCase().indexOf("error: widget import")&&(i.remove(t),e(".notice.notice-warning:empty",n).remove())}))})),e(document).on("reycore/ocdi/failed_import ",(function(t){e(".js-ocdi-ajax-response").append('<div class="notice notice-error is-dismissible"><p>'+reyCoreAdmin.ocdi_strings.seek_help+"</p></div>"),i=!1,e("body").removeClass("rey-is-importing"),document.title=reyCoreAdmin.ocdi_strings.title_done})),e(document).on("reycore/ocdi/import_demo",(function(t,n,r,a,o,s){i=!0,document.title=reyCoreAdmin.ocdi_strings.title_importing;var c=function(){a.dialog("close"),e.ocdiGridLayoutImport(n,r),e("body").addClass("rey-is-importing")},d=reyAdminParams&&reyAdminParams.tgmpa&&2==reyAdminParams.tgmpa,l=[],u=new URL(window.location.href).searchParams.get("page")||"",p=e("#js-plugin-dep--"+s[n].slug).find('input[type="checkbox"]');if(p.length){p.each((function(t,n){e(n).prop("checked")&&l.push(e(n).val()),e(n).prop("disabled",!0)})),o.addClass("disabled"),o.prev(".ui-button").addClass("disabled"),a.closest(".wp-dialog--rey").find(".ui-dialog-titlebar-close").hide(300),a.dialog("option","closeOnEscape",!1),e(".rey-pluginDeps input:checked",a).closest("li").addClass("--is-installing"),a.append("<p class='reyAdmin-response reyAdmin-notice --info'>"+reyCoreAdmin.ocdi_strings.installing_plugins_text+"</p>");var f=!0,m=function(){var t={method:"post",url:reyCoreAdmin.ajax_url,dataType:"text",cache:!1,data:{action:"rey_install_plugin_dependencies",security:reyCoreAdmin.ajax_nonce,plugins:l,page:u},success:function(t){var n=function(e){if(d)return e;var t=/{("success"[^}]+)}/g.exec(e);return!(!t||!t.length)&&JSON.parse(t[0])}(t);n?(n.success&&!0===n.success&&!1!==n.data?(e(".rey-pluginDeps li[data-slug='"+n.data+"']",a).hide(400),m()):(e(".reyAdmin-response",a).text(reyCoreAdmin.ocdi_strings.finished_installing_plugins),setTimeout((function(){c()}),1e3)),f=!1):(o.removeClass("loading"),e(".reyAdmin-response",a).remove(),a.append("<p class='reyAdmin-response reyAdmin-notice --error'>"+n.data+"</p>"))},error:function(t,n,i){e(".reyAdmin-response",a).remove(),a.append("<p class='reyAdmin-response reyAdmin-notice --error'>"+reyCoreAdmin.ocdi_strings.something_went_wrong+"</p>")}};f&&(t.data.first=!0),d&&(t.dataType="json"),e.ajax(t)};m()}else c()})),t=e("#tmpl-customize-control-kirki-toggle-content"),n=(n=t.text()).replace("screen-reader-text","screen-reader-text-reyToggle"),t.text(n);var r,a=function(t){var n=this;this.init=function(){t&&(this.config=e.extend({scope:"","condition-attribute":"data-condition"},t),this.config.scope&&e(this.config.scope).length&&(this.checkConds(),e("input, select",this.config.scope).on("change",(function(e){n.checkConds()}))))},this.checkConds=function(){var t=this;e("["+this.config["condition-attribute"]+"]",this.config.scope).each((function(n,i){var r=e(i),a=JSON.parse(r.attr(t.config["condition-attribute"])||"{}"),o=[];if(!e.isEmptyObject(a)){e.each(a,(function(n,i){var r=e('[name="'+i.name+'"]',t.config.scope),a=r.val();r.is('[type="checkbox"]')&&(a=r.prop("checked")),o.push(t.evaluateCondition(i.value,a,i.compare))}));var s=o.every((function(e){return!0===e}));r.toggleClass("hidden",!s)}}))},this.evaluateCondition=function(e,t,n){if("==="===n)return e===t;if("=="===n||"="===n||"equals"===n||"equal"===n)return e==t;if("!=="===n)return e!==t;if("!="===n||"not equal"===n)return e!=t;if(">="===n||"greater or equal"===n||"equal or greater"===n)return t>=e;if("<="===n||"smaller or equal"===n||"equal or smaller"===n)return t<=e;if(">"===n||"greater"===n)return t>e;if("<"===n||"smaller"===n)return t<e;if("contains"===n||"in"===n){if(_.isArray(e)&&_.isArray(t))return _.each(t,(function(t){if(e.includes(t))return found=!0,!1})),found;if(_.isArray(t))return _.each(t,(function(t){t==e&&(found=!0)})),found;if(_.isObject(t))return _.isUndefined(t[e])||(found=!0),_.each(t,(function(t){e===t&&(found=!0)})),found;if(_.isString(t))return _.isString(e)?-1<e.indexOf(t)&&-1<t.indexOf(e):-1<e.indexOf(t)}return"!contains"===n||"does not contain"===n||"not in"===n?!this.evaluateCondition(e,t,"contains"):e==t},this.init()},o=function(){e("[data-rey-controls]").each((function(){var t=e(this),n=JSON.parse(t.attr("data-rey-controls")||"{}");if(!e.isEmptyObject(n)){var i=!1;if(n["form-scope"]){var r=e(n["form-scope"]);r.length&&(i=r.is("form")?r:r.closest("form"))}else t.is("form")&&(i=t);i&&new a({scope:i,"condition-attribute":n["condition-attribute"]})}}))},s=function(t){this.init=function(){this.scope=t||e("#widgets-right .widget-content"),this.dependencies(),this.priceFilterWidget(),this.repeaterField(),this.makeTabs(),this.makeTitle()},this.dependencies=function(){this.scope.each((function(){new a({scope:this})}))},this.makeTabs=function(){e(".rey-widgetTabs-wrapper",this.scope).each((function(t,n){var i=e(n),r=e(".rey-widgetTabs-buttons span",i),a=e(".rey-widgetTabs-tabContent",i);r.on("click",(function(t){t.preventDefault();var n=e(this).attr("data-tab");r.removeClass("--active"),a.removeClass("--active"),e(this).addClass("--active"),e('.rey-widgetTabs-tabContent[data-tab="'+n+'"]',i).addClass("--active")}))}))},this.makeTitle=function(){var t=e(".rey-widgetToTitle",this.scope);t.each((function(n,i){var r=e(i).closest(".widget").find(".widget-title h3");e("<span/>").addClass(t.attr("data-class")||"").html(t.html()).appendTo(r)}))},this.repeaterField=function(){e(".rey-widgetRepeater-add",this.scope).on("click",(function(t){var n=e(this).closest(".rey-widgetRepeater-wrapper"),i=e(".rey-widgetRepeater-listWrapper",n),r=wp.template("rey-"+i.attr("data-id"))({int:parseInt(e(".rey-widgetRepeater-list.--default",i).last().attr("data-key")||10)+1});i.append(r)})),e(document).on("click",".rey-widgetRepeater-remove",(function(t){var n=e(this);n.closest(".rey-widgetRepeater-listWrapper");n.parent().hide().remove()}))},this.priceFilterWidget=function(){var t=this;e(".rey-widgetRangePoints-add",this.scope).on("click",(function(t){var n=e(this).closest(".rey-widgetRangePoints-wrapper"),i=e(".rey-widgetRangePoints-listWrapper",n),r=wp.template("rey-"+i.attr("data-id"))({int:parseInt(e(".rey-widgetRangePoints-list.--default",i).last().attr("data-key")||10)+1});i.append(r)})),e(document).on("click",".rey-widgetRangePoints-remove",(function(t){var n=e(this);n.closest(".rey-widgetRangePoints-listWrapper");n.parent().hasClass("--start")||n.parent().hasClass("--end")||n.parent().hide().remove()})),e.each(["start","end"],(function(n,i){e(".rey-widgetRangePoints-add-"+i,t.scope).on("click",(function(t){t.preventDefault();var n=e(this).closest(".rey-widgetRangePoints-wrapper"),r=e(".rey-widgetRangePoints-list.--"+i,n);r.removeClass("--hidden"),e('input[type="hidden"]',r).val("1"),e(this).addClass("--inactive")})),e(document).on("click",".rey-widgetRangePoints-list.--"+i+" .rey-widgetRangePoints-remove",(function(n){n.preventDefault();var r=e(this);r.parent().addClass("--hidden"),e('input[type="hidden"]',r.parent()).val(""),e(".rey-widgetRangePoints-add-"+i,t.scope).removeClass("--inactive")}))}))},this.init()},c=function(){var t="#widgets-only-visible-terms--",n=[],i=e(".wp-admin.widgets-php #widgets-right"),r=e('a[href^="'+t+'"]',i);r.each((function(a,o){var s=e(o).attr("href").split("--");n.push(s[1]),r.length-1===a&&e.post({url:reyCoreAdmin.ajax_url,data:{term_ids:n,action:"rey_custom_sidebars_links",security:reyCoreAdmin.ajax_nonce},success:function(n){"object"!=typeof n||n.error||e.each(n,(function(n,r){var a=e('a[href^="'+t+n+'"]',i);a.length&&a.attr({href:r,target:"_blank"})}))}})}))};e(document).on("widget-added widget-updated",(function(e,t){new s(t)})),e(document).ready((function(){new s,new c,new o})),void 0!==(r=wp.customize)&&r.bind("ready",(function(){r.section.each((function(e){"widgets"===e.params.panel&&e.expanded.bind((function(e){e&&new s}))}))})),e(".js-toggle-ocdi-settings").on("change",(function(t){var n=e(t.target),i=n.closest(".rey-toggleSwitch"),r=n.attr("data-setting");i.addClass("--disabled"),e.ajax({method:"post",url:reyCoreAdmin.ajax_url,data:{action:"change_ocdi_setting",security:reyCoreAdmin.ajax_nonce,status:n.prop("checked"),setting:r},success:function(e){e&&e.data&&n.prop("checked",e.data),i.removeClass("--disabled")},error:function(e,t,n){console.error(e),console.error(t),console.error(n)}})})),e(".js-rey-demos-adjust-settings").on("click",(function(t){t.preventDefault(),e(this).parent().find(".rey-demosImportSettings").toggleClass("--hidden")})),e(".reyAdm-notice").each((function(){var t=e(this),n=t.attr("data-key");if(n){var i="reycore-dismissed-"+n;rey.util.ls.get(i)&&!0===rey.util.ls.get(i)||t.addClass("--visible"),e(".reyAdm-noticeDismiss[data-dismiss]",t).on("click",(function(n){n.preventDefault();var r=e(this),a=r.attr("data-dismiss");"1day"===a?(t.removeClass("--visible"),rey.util.ls.set(i,!0,864e5)):"always"===a&&(t.css({opacity:".8","pointer-events":"none"}),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:r.attr("data-action"),security:reyCoreAdmin.ajax_nonce},success:function(e){e&&1==e.success?t.removeClass("--visible"):t.css({opacity:"","pointer-events":""})},error:function(e,n,i){t.css({opacity:"","pointer-events":""})}}))}))}})),e(document).on("click",".rey-whatsNew .__never-show",(function(t){t.preventDefault();var n=e(this);n.addClass("--loading disabled"),rey.ajax.request("whatsnew_page_visibility",{cb:function(e){e&&e.success&&(!e.data||e.data&&e.data.error?n.text("Error! Check console."):(n.text("Done! Redirecting to dashboard.."),setTimeout((function(){window.location.href=reyAdminParams.dashboard_url}),2e3)))}})})),e(document).on("click",".rey-whatsNew .__hide-until-next",(function(t){t.preventDefault();var n=e(this);n.addClass("--loading disabled"),rey.ajax.request("whatsnew_hide_until_next_major",{cb:function(e){e&&e.success&&(!e.data||e.data&&e.data.error?n.text("Error! Check console."):(n.text("Done! Redirecting to dashboard.."),setTimeout((function(){window.location.href=reyAdminParams.dashboard_url}),2e3)))}})})),e(".js-ig-refresh-token").on("click",(function(t){t.preventDefault();var n=e(this);n.addClass("--loading").text(reyCoreAdmin.strings.refreshing_btn_text),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:"rey_refresh_ig_token",security:reyCoreAdmin.ajax_nonce},success:function(e){e&&1==e.success&&(n.text(reyCoreAdmin.strings.reloading),setTimeout((function(){location.reload()}),1e3))}})})),e(".js-ig-migrate-token").on("click",(function(t){t.preventDefault();var n=e(this);n.addClass("--loading").text(reyCoreAdmin.strings.migrating_btn_text),e.ajax({url:reyCoreAdmin.ajax_url,cache:!1,data:{action:"rey_migrate_ig_token",security:reyCoreAdmin.ajax_nonce},success:function(e){e&&e.success&&(n.text(reyCoreAdmin.strings.reloading),setTimeout((function(){location.reload()}),1e3))}})}));var d=function(){localStorage.setItem("reycore/infinite_cleanup",!0)};e(".wp-admin #post").on("submit",d),wp&&wp.customize&&wp.customize.bind("save",d);var l;l={},e(document).on("mouseenter",".rey-previewIframe",(function(e){var t=e.currentTarget,n=t.getAttribute("data-id");if(!t.getAttribute("data-loaded")){var i=t.querySelector("iframe");i&&(l[n]=setTimeout((function(){var e=i.getAttribute("data-src");i.setAttribute("src",e),i.addEventListener("load",(function(){t.classList.add("--loaded"),t.setAttribute("data-loaded","")}))}),300))}})).on("mouseleave",".rey-previewIframe",(function(e){var t=e.currentTarget,n=t.getAttribute("data-id");t.getAttribute("data-loaded")||clearTimeout(l[n])}))}(jQuery);