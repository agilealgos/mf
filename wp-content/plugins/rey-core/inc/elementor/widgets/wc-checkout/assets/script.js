!function(e,t,i){"use strict";var o={steps:["info","shipping","payment"],currentStep:"info",sameBilling:!0,sameShipping:!0,init:function(e,t){if("undefined"==typeof wc_checkout_params&&!rey.vars.elementor_edit_mode)return console.error("Page is not set as a Checkout page. Access WooCommerce Settings > Advanced, and make sure to set the Checkout page to this page."),!1;if(void 0===t.fn.block)return!1;this.page_selector=".rey-checkoutPage.--layout-custom",this.$page=t(this.page_selector,e),this.$form=t(".rey-checkoutPage-form",this.$page),this.$review=t(".rey-checkoutPage-review",this.$page),this.billingFirst=this.$page.hasClass("--bfirst"),this.shippingDisabled=!t('.__step[data-step="shipping"]',this.$page).length,this.shippingDisabled&&(this.steps=["info","payment"]),this.params=JSON.parse(this.$page.attr("data-bto-custom")||"{}");var i=0;if(window.location.hash){var o=window.location.hash.replace("#",""),n=this.steps.indexOf(o);-1!==n&&0!==n&&this.validate_fields("info")&&(i=n)}this.go_to_step(i,!0,!0),this.update_crumbs(),this.activateS2(),this.update_form_reviews(),this.events(),this.sticky_review(),this.make_tooltips()},events:function(){var t=this;e(document).on("click",this.page_selector+' button[name="apply_coupon"]',(function(i){i.preventDefault(),t.apply_coupon(e(this))})),e(document).on("click",this.page_selector+" .__step .__step-fwd",(function(e){e.preventDefault(),t.go_to_next_step()})),e(document).on("click",this.page_selector+' .__step .__step-back[href^="#"]',(function(e){e.preventDefault(),t.go_to_prev_step()})),e(document).on("click",this.page_selector+" .rey-checkoutPage-review-toggle",(function(t){t.preventDefault(),e(this).parent().toggleClass("--mob-active")})),e(document).on("click",this.page_selector+" .rey-checkoutPage-crumbs a",(function(i){var o=e(this).attr("data-step");"cart"!==o&&(i.preventDefault(),t.go_to_step(t.steps.indexOf(o)))})),e(document).on("click",this.page_selector+" .rey-formReview-action a",(function(i){i.preventDefault();var o=e(this).attr("data-target");"billing"!==o?t.go_to_step(t.steps.indexOf(o)):e(".rey-checkoutDetails-billing").slideToggle()})),e(document).on("change",this.page_selector+" .rey-checkoutChoose-item input[type='radio']",(function(i){var o="different"===e(this).val(),n=e(this).closest(".rey-checkoutChoose"),s=e(".woocommerce-billing-fields__field-wrapper",n);n.toggleClass("--active",o),t.sameBilling=!o,e('input[name="ship_to_different_address"]').val(o?1:0),o?(e('input:not(input[name="ship_to_different_address"]):not(#shipping_country), textarea, select',s).val(""),t.clone_targeted_shipping_fields("#shipping_country")):t.clone_shipping_fields()})),e(document).on("change",this.page_selector+" .woocommerce-shipping-methods input[type='radio']",(function(e){t.$page.addClass("--loading")})),e(document).on("change",this.page_selector+" input[name='ship_to_different_address']",(function(i){var o=e(this),n=e(".woocommerce-shipping-fields__field-wrapper",t.$page);o.prop("checked")?(t.sameShipping=!1,n.slideDown(),e('input:not(input[name="ship_to_different_address"]):not(#shipping_country), textarea, select:not(#shipping_country)',n).val(""),e("#shipping_state",n).trigger("change")):(t.sameShipping=!0,n.slideUp(250,(function(){t.clone_billing_fields()})))})),e(document.body).on("reycore/woocommerce/checkout/changed_step",(function(i){t.update_crumbs(),t.update_form_reviews(),t.clone_shipping_fields(),t.clone_billing_fields(),t.animate_top(),t.make_tooltips(),t.$review.removeClass("--mob-active"),e(".woocommerce-error, .woocommerce-message, .woocommerce-info",t.$page).remove()})),e(document.body).on("updated_checkout",(function(e){t.update_form_reviews(),t.$page.removeClass("--loading")})),e(document).on("change",".__step[data-step='info'] .woocommerce-shipping-fields input, .__step[data-step='info'] .woocommerce-shipping-fields textarea, .__step[data-step='info'] .woocommerce-shipping-fields select",(function(i){wc_checkout_params.exclude_cloning_fields&&e(this).is(wc_checkout_params.exclude_cloning_fields)||t.clone_shipping_fields()})),e(document).on("change",".__step[data-step='info'] .woocommerce-billing-fields input, .__step[data-step='info'] .woocommerce-billing-fields textarea, .__step[data-step='info'] .woocommerce-billing-fields select",(function(e){t.clone_billing_fields()})),e(document.body).on("checkout_error",(function(e){t.refresh_events()})),e(window).bind("popstate",(function(e){if(window.location.hash){var i=window.location.hash.replace("#",""),o=t.steps.indexOf(i);-1!==o&&0!==o&&t.validate_fields("info")&&t.go_to_step(t.steps.indexOf(i),!0)}}))},refresh_events:function(){e(".woocommerce-error a[data-reymodal]").on("click",(function(t){var i=JSON.parse(e(this).attr("data-reymodal")||"{}");(!e.isEmptyObject(i)&&"undefined"!==i.content&&i.content&&(i.content=e(i.content)),"undefined"!=typeof ReyModal)&&new ReyModal({linkAttributeName:!1,catchFocus:!1,closeOnEsc:!0,backscroll:!0}).init().open(i)}))},animate_top:function(){e("html, body").animate({scrollTop:this.$page.offset().top-rey.vars.adminBar-25},"fast",(function(e){return--e*e*e+1}))},update_crumbs:function(){e(" .rey-checkoutPage-crumbs li").removeClass("--active"),e(" .rey-checkoutPage-crumbs a[data-step="+this.currentStep+"]").parent().addClass("--active")},update_form_reviews:function(){var t=this;e(".rey-formReview-block").each((function(i,o){var n=e(o),s=e(".rey-formReview-content",n),a=s.attr("data-fill");if("email"===a){var c=e("#billing_email");c.length&&s.text(c.val())}else if("address_ship"===a){var r=[],p=["shipping_address_1","shipping_city","shipping_state","shipping_postcode","shipping_country"];if(t.params.custom_ship_to){var l=t.params.custom_ship_to.trim().split(",");l.length&&(p=p.concat(l))}e.each(p,(function(t,i){var o=e("#"+i);o.length&&r.push(o.val())})),s.text(r.filter(Boolean).join(", "))}else if("address_bill"===a){var d=[],h=["billing_address_1","billing_city","billing_state","billing_postcode","billing_country"];if(t.params.custom_bill_to){var _=t.params.custom_bill_to.trim().split(",");_.length&&(h=h.concat(_))}e.each(h,(function(t,i){var o=e("#"+i);o.length&&d.push(o.val())})),s.text(d.filter(Boolean).join(", "))}else if("method"===a){var g=e("#shipping_method input[type='radio']:checked");if(g.length||(g=e("#shipping_method input[type='hidden']")),g.length){var u=g.next("label"),m=e(".__label",u);m.length&&(u=m),s.text(u.text())}}}))},go_to_next_step:function(){this.go_to_step(this.steps.indexOf(this.currentStep)+1)},go_to_prev_step:function(){this.go_to_step(this.steps.indexOf(this.currentStep)-1,!0)},go_to_step:function(t,i,o){if(!o){var n=!0;if(this.validate_fields("info")||(n=!1),n&&this.billingFirst&&!this.sameShipping&&(this.validate_fields("shipping")||(n=!1)),!n)return}var s=e(".__step[data-step]").eq(t),a=this;if(this.currentStep=s.attr("data-step"),s.length){this.$page.attr("data-active-step",this.currentStep),this.$page.addClass("--loading");var c=function(){0===t&&e("#billing_email").trigger("focus"),a.$page.removeClass("--loading"),s.show(),s.siblings(".__step").hide()};i?c():setTimeout(c,1200),window.location.hash=this.currentStep,e(document.body).trigger("reycore/woocommerce/checkout/changed_step",[s])}},validate_fields:function(t){var i=[],o=e(".__step[data-step='"+t+"'] .validate-required");e(".__invalid-error",this.$page).remove();for(var n=0;n<o.length;n++){var s=o[n],a=e("input, textarea, select",s),c=a.val();if(""==c||"email"===a.attr("type")&&!/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,})+$/.test(c)){var r=!0;e("input#createaccount").prop("checked")||a.closest(".create-account").length&&(r=!1),r&&(e(s).addClass("woocommerce-invalid-required-field woocommerce-invalid"),e('<span class="__invalid-error">'+rey.params.checkout.error_text+"</span>").insertAfter(e(".woocommerce-input-wrapper",s)),i.push("1"))}if(o.length-1===n)return!i.length}},clone_billing_fields:function(){if(!this.shippingDisabled&&this.billingFirst&&this.sameShipping){var t=e(".woocommerce-shipping-fields"),i=e(".woocommerce-billing-fields");e("input, textarea, select",i).each((function(i,o){var n=e(o),s=n.val(),a=n.attr("name"),c=a.replace("billing_","shipping_"),r=e('[name="'+c+'"]',t);if(r.length)r.val(s).trigger("change");else{var p=e('[name="'+a+'"]',t);p.length&&p.val(s)}}))}},clone_shipping_fields:function(){this.sameBilling&&this.clone_targeted_shipping_fields("input, textarea, select")},clone_targeted_shipping_fields:function(t){if(!this.shippingDisabled&&!this.billingFirst){var i=e(".woocommerce-shipping-fields"),o=e(".woocommerce-billing-fields");e(t,i).each((function(t,i){var n=e(i),s=n.val(),a=n.attr("name").replace("shipping_","billing_"),c=e('[name="'+a+'"]',o);c.length&&c.val(s).trigger("change")}))}},apply_coupon:function(t){this.$review.is(".--loading")||this.$review.parents(".--loading").length||this.$review.addClass("--loading");var i=this,o=t.siblings("input[name='coupon_code']"),n=o.val(),s={security:wc_checkout_params.apply_coupon_nonce,coupon_code:n};e.ajax({type:"POST",url:wc_checkout_params.wc_ajax_url.toString().replace("%%endpoint%%","apply_coupon"),data:s,dataType:"html",success:function(o){e(".woocommerce-error, .woocommerce-message, .woocommerce-info",this.$page).remove(),e(".__notice",this.$page).remove();var n=e('<div class="__notice --clean-wc-notice">'+o+"</div>").insertAfter(t.parent());e(document.body).trigger("applied_coupon_in_checkout",[s.coupon_code]),e(document.body).trigger("update_checkout",{update_shipping_method:!1}),e(".woocommerce-message",n).length&&i.$review.addClass("--mob-active")},complete:function(){i.$review.removeClass("--loading"),o.val("")}})},sticky_review:function(){rey.vars.is_desktop&&this.$page.is(".--sticky-review")&&e(".rey-siteWrapper").addClass("--o-visible")},activateS2:function(){void 0!==e.fn.selectWoo&&e("select:not(.select2-hidden-accessible)",this.$form).each((function(){var t={placeholder:e(this).attr("data-placeholder")||e(this).attr("placeholder")||"",width:"100%",containerCssClass:"select2-reyStyles",dropdownCssClass:"select2-reyStyles"};e(this).on("select2:select",(function(){e(this).focus()})).selectWoo(t)}))},make_tooltips:function(){e(".woocommerce-shipping-fields .woocommerce-input-wrapper span.description, .woocommerce-billing-fields .woocommerce-input-wrapper span.description").each((function(t,i){var o=e(i),n=o.html();if(rey){var s=rey.frontend.svgIcon.get("help");e('<span class="rey-inputTip" data-rey-tooltip="'+n+'" data-tooltip-size="180">'+s+"</span>").insertAfter(o)}o.remove()}))}};rey.hooks.addAction("elementor/init",(function(e){e.registerElement({name:"reycore-wc-checkout.default",cb:function(e,t){o.init(e,t)}})}))}(jQuery,window.elementorFrontend,window.elementorModules);