!function(t){"use strict";var a=function(a){var e=this;this.selectors={swatch_list:".rey-swatchList",swatch_item:".rey-swatchList-item",attr_data_selector:"data-attribute_name",attr_data_prefix:"attribute_",reset_link:".rey-resetVariations"},this.el={},this.supports={},this.cache={},this.swatchLists=[],this.init=function(){this.el.$form=a.$form,this.el.$product=this.el.$form.closest(".product"),this.supports.titles_update=!rey.vars.is_desktop,this.el.$catalogWrapper=t(".rey-productVariations2",this.el.$product),this.supports.is_catalog=this.el.$product.is("li")&&this.el.$catalogWrapper.length,this.supports.catalog_all=this.supports.is_catalog&&this.el.$catalogWrapper.hasClass("--all-attr"),this.supports.redirect_pdp=this.supports.is_catalog&&!this.supports.catalog_all&&this.el.$catalogWrapper.hasClass("--redirect-pdp"),this.el.$updatableLists=t("select.--update",this.el.$form),this.supports.pdp_single_gallery_update=this.el.$product.hasClass("--swatch-update-gallery")&&this.el.$updatableLists.length,a.$attributeFields.length||(a.$attributeFields=t("select[data-attribute_name]",this.el.$form)),a.$attributeFields.each((function(t,a){Object.create(e.swatchList).init(a)})),this.supports.is_catalog&&this.initCatalog(),this.catalogHandleAjaxThreshold(),this.pdpHandleAjaxTreshold(),this.checkSelected(),this.checkDisabled(),this.changeVariableProductImageOnFilter(),this.events(),this.el.$form.addClass("--init")},this.events=function(){t(this.selectors.swatch_item,this.el.$form).on("click",(function(t){t.preventDefault()})),this.el.$form.on("reycore/woocommerce/swatch_change",(function(s,i,r){var l=e.matchVariation(i.$select.val(),i.attributeName);if(e.updateCatalog(l),e.toggleResetLink(),e.supports.pdp_single_gallery_update){if(a.useAjax&&!l&&i.$select.hasClass("--update")){var c=a,o={};return c.xhr&&c.xhr.abort(),e.el.$form.block({message:null,overlayCSS:{background:"#fff",opacity:.6}}),o[i.attributeName]=i.$select.val(),o.product_id=parseInt(e.el.$form.data("product_id"),10),o.custom_data=e.el.$form.data("custom_data"),void(c.xhr=t.ajax({url:wc_add_to_cart_variation_params.wc_ajax_url.toString().replace("%%endpoint%%","get_variation"),type:"POST",data:o,success:function(t){t&&e.fireSingleVariation(t)},complete:function(){e.el.$form.unblock()}}))}l&&e.fireSingleVariation(l)}})),this.el.$form.on("woocommerce_update_variation_values",(function(t){e.checkDisabled()})),this.el.$form.on("found_variation",(function(t,a){e.catalogAtcText.update(a),e.setAjaxVariationsDisabled(a)})),this.el.$form.on("reset_data",(function(t){e.catalogAtcText.update()})),this.el.$form.on("click.wc-variation-form",this.selectors.reset_link,{variationForm:a},(function(t){t.preventDefault(),t.data.variationForm.$attributeFields.val("").trigger("change"),t.data.variationForm.$form.trigger("reset_data")})),rey.hooks.addAction("ajaxfilters/finished",(function(t){e.changeVariableProductImageOnFilter(t)}))},this.fireSingleVariation=function(a){var e=t("select[data-attribute_name]",this.el.$form);e.filter((function(t,a){return""!==a.value&&null!==a.value&&!1!==a.value})).length!==e.length&&(a.force_update_main_image=!0,this.el.$form.trigger("reycore/woocommerce/found_variation/single",[a]))},this.checkSelected=function(){var t="undefined"!=typeof chosenAttributes?chosenAttributes:a.getChosenAttributes(),s=t.data;if(this.toggleResetLink(),t.count&&t.count===t.chosenCount){var i=a.findMatchingVariations(a.variationData,s).shift();e.updateCatalog(i),e.catalogAtcText.update(i)}},this.checkDisabled=function(){a.useAjax&&!this.supports.is_catalog||t.each(this.swatchLists,(function(t,a){e.checkDisabledItem(a)}))},this.checkDisabledItem=function(a){t(e.selectors.swatch_item,a).addClass("--disabled"),t(a).prev("select").find("option:not([disabled])").each((function(){t(e.selectors.swatch_item+'[data-term-slug="'+t(this).attr("value")+'"]',a).removeClass("--disabled")}))},this.pdpHandleAjaxTreshold=function(){},this.setAjaxVariationsDisabled=function(t){!e.supports.is_catalog&&a.useAjax&&e.__pdp_ajax_variations_data},this.toggleResetLink=function(){t(this.selectors.reset_link).toggleClass("--hidden",!(a.getChosenAttributes().chosenCount>0))},this.swatchList={init:function(a){this.$select=t(a),this.attributeName=this.$select.attr(e.selectors.attr_data_selector),this.attributeId=this.attributeName.replace(e.selectors.attr_data_prefix,""),this.$swatchList=t(e.selectors.swatch_list,e.el.$form).filter("["+e.selectors.attr_data_selector+'="'+this.attributeName+'"]'),this.preInit(),this.$swatchList.length&&(e.swatchLists.push(this.$swatchList),this.$swatchItems=t(e.selectors.swatch_item,this.$swatchList),this.$swatchItems.length&&this.events())},preInit:function(){var a=this;e.el.$product.hasClass("rey-swatches--show-selected--name")?e.supports.titles_update="name":e.el.$product.hasClass("rey-swatches--show-selected--desc")&&(e.supports.titles_update="desc"),e.supports.titles_update&&(this.$label=t('label[for="'+this.attributeId+'"]',e.el.$form),this.updateTitles(),this.$select.on("change",(function(t){e.supports.titles_update&&a.updateTitles()}))),this.$select.on("change",(function(t){e.el.$form.trigger("reycore/woocommerce/swatch_change",[a,t.target.value])})),e.el.$form.trigger("reycore/woocommerce/swatch/preinit")},events:function(){var a=this;this.$swatchItems.on("click",(function(s,i){s.preventDefault();var r=t(this),l=r.attr("data-term-slug");if(e.supports.redirect_pdp){var c=e.el.$form.attr("action"),o=-1!==c.indexOf("?")?"&":"?";window.location=c+o+"attribute_"+r.attr("data-attribute-name")+"="+l}else{if(!a.$swatchList.hasClass("--deselection-clear")&&r.hasClass("--selected")&&!i)return r.removeClass("--selected").attr("aria-checked","false"),void a.$select.val("").trigger("change").find('option[value=""]').prop("selected",!1);a.$swatchItems.removeClass("--selected").attr("aria-checked","false"),r.addClass("--selected").attr("aria-checked","true"),a.$select.val(l).trigger("change").find('option[value="'+l+'"]').prop("selected",!0)}})),this.$select.on("change",(function(t){t.target.value||a.$swatchItems.removeClass("--selected").attr("aria-checked","false")}))},updateTitles:function(){var a="",s=this.$select.next(".rey-swatchList").find(".--selected");s.length&&("name"===e.supports.titles_update?a=s.attr("aria-label"):"desc"===e.supports.titles_update&&(a=s.attr("data-description")||s.attr("aria-label")),this.$label.nextAll(".__name").remove(),t('<span class="__name">'+a+"</span>").insertAfter(this.$label))}},this.catalogHandleAjaxThreshold=function(){this.supports.is_catalog&&a.useAjax&&this.el.$catalogWrapper.hasClass("--ajax")},this.initCatalog=function(){this.catalogGallery.init(),this.catalogPrice.init(),this.catalogUrl.init(),this.catalogAtcText.init(),this.catalog_is_init=!0},this.lastSelectedVariation=null,this.updateCatalog=function(t){this.catalog_is_init&&this.supports.is_catalog&&t&&(this.catalogGallery.update(t),this.catalogPrice.update(t),this.catalogUrl.update(t))},this.catalogGallery={is_init:!1,init:function(){if(t("select[data-attribute_name]",e.el.$form).length){var a=!1;if(t.each(["--stretch-image-contain","--stretch-image-images","--stretch-image-cover"],(function(t,s){e.el.$product.hasClass(s)&&(a=!0)})),!a){if(this.vars={product_gallery:t(".rey-productThumbnail",e.el.$product),second_class:"--extraImg-second",slideshow_class:"--extraImg-slideshow"},this.vars.cached_gallery=this.vars.product_gallery.html(),this.vars.is_active_second=e.el.$product.hasClass(this.vars.second_class),this.vars.$slideshow=t(".splide",this.vars.product_gallery),this.vars.is_active_slideshow=e.el.$product.hasClass(this.vars.slideshow_class)&&this.vars.$slideshow.length,this.vars.can_change_slideshow=!1,this.vars.is_active_slideshow){var s='<a href="{{link}}" class="woocommerce-LoopProduct-link woocommerce-loop-product__link varImage --var-hidden"><img src="" class="rey-thumbImg img--1" alt=""></a>',i=t(".woocommerce-LoopProduct-link",this.vars.product_gallery).first().attr("href");if(i||(i=t(".splide__slide",this.vars.product_gallery).first().attr("href")),i){s=s.replace("{{link}}",i),this.vars.can_change_slideshow=!0;var r=t(".varImage",this.vars.product_gallery);r.length?this.vars.$slideshow_var=r:this.vars.$slideshow_var=t(s).appendTo(this.vars.product_gallery)}}this.refreshVars(),this.is_init=!0}}},refreshVars:function(){this.vars.product_gallery=t(".rey-productThumbnail",e.el.$product),this.vars.$second_image=t(".rey-productThumbnail__second",this.vars.product_gallery),this.vars.is_active_slideshow?this.vars.thumb_img=t(".varImage img",this.vars.product_gallery):this.vars.thumb_img=t(".rey-thumbImg",this.vars.product_gallery).first()},update:function(t){this.is_init&&(t?t&&t.image&&t.image.thumb_src&&t.image.thumb_src.length>1&&this.vars.thumb_img.attr("src")!==t.image.thumb_src&&(this.vars.is_active_second?(e.el.$product.removeClass(this.vars.second_class),this.vars.$second_image.remove()):this.vars.is_active_slideshow&&(this.vars.$slideshow_var.removeClass("--var-hidden"),this.vars.$slideshow.addClass("--var-hidden")),this.vars.thumb_img.attr({src:t.image.thumb_src,height:t.image.thumb_src_h,width:t.image.thumb_src_w,title:t.image.title,"data-caption":t.image.caption,alt:t.image.alt,srcset:"",sizes:""})):this.deselect(t))},deselect:function(){if(this.vars.is_active_slideshow)return this.vars.$slideshow_var.addClass("--var-hidden"),void this.vars.$slideshow.removeClass("--var-hidden");this.vars.product_gallery.html(this.vars.cached_gallery),this.refreshVars(),this.vars.is_active_second&&e.el.$product.addClass(this.vars.second_class)}},this.catalogPrice={init:function(){(e.supports.catalog_all||rey.params.updateCatalogPriceSingleAttribute)&&(this.$price=t(".price",e.el.$product),this.$price.length&&(this.initialHtml=this.$price[0].innerHTML))},update:function(a){this.initialHtml&&(a?a.price_html&&this.$price.html(t(a.price_html).html()):this.$price.html(this.initialHtml))}},this.catalogUrl={init:function(){this.$atcBtn=t("a[data-product_id]",e.el.$product),this.$atcBtn.length&&(this.url=this.$atcBtn.attr("href"))},update:function(s){if(this.url)if(s){var i=this.url;a.$attributeFields.each((function(a,s){var r=t(s),l=r.attr(e.selectors.attr_data_selector),c=r.val();c&&(i=e.addUrlParameter(i,l,c))})),""!==i&&(this.$atcBtn.attr("href",i),t(".woocommerce-loop-product__link",e.el.$product).attr("href",i))}else this.$atcBtn.attr("href",this.url)}},this.catalogAtcText={init:function(){e.supports.catalog_all&&(this.$atcBtn=t(".add_to_cart_button.product_type_variable[data-product_id]",e.el.$product),this.$atcBtn.length&&(this.$atcBtnInner=t(".__text",this.$atcBtn),this.initialText=this.$atcBtn.text(),this.initialAriaLabel=this.$atcBtn.attr("aria-label"),this.productId=this.$atcBtn.attr("data-product_id"),this.activeText=e.el.$form.attr("data-atc-text"),this.loopQty=this.$atcBtn.closest(".rey-loopQty"),this.dataAttributes={variation_id:""},a.$attributeFields.each((function(a,s){var i=t(s).attr(e.selectors.attr_data_selector);e.catalogAtcText.dataAttributes[i]=""}))))},update:function(a){if(this.initialText&&this.activeText&&this.productId){var s={};if(!a)return s={"aria-label":this.initialAriaLabel},t.each(this.dataAttributes,(function(t,a){s["data-"+t]=""})),this.$atcBtn.removeClass("ajax_add_to_cart").attr(s),this.$atcBtnInner.text(this.initialText),void this.loopQty.removeClass("--visible");s={"aria-label":this.activeText},t.each(this.dataAttributes,(function(i,r){var l;"variation_id"===i?(l=a.variation_id,e.catalogAtcText.$atcBtn.attr("data-product_id",a.variation_id)):l=t('select[name="'+i+'"]',e.el.$form).val(),s["data-"+i]=l})),this.$atcBtn.addClass("ajax_add_to_cart").attr(s),this.$atcBtnInner.text(this.activeText),this.loopQty.addClass("--visible")}}},this.changeVariableProductImageOnFilter=function(a){a=a||t(".reyajfilter-before-products ul.products"),t(e.selectors.swatch_list,a).each((function(a,s){var i=t(s),r=i.attr("data-attribute_name");if(r){var l=t('.reyajfilter-layered-nav[data-taxonomy="'+r.replace("attribute_","")+'"] li.chosen > a');if(l.length){var c=l.first().attr("data-slug")||"";if(c){var o=t('[data-term-slug="'+c+'"]',i);o.length&&!e.supports.redirect_pdp&&setTimeout((function(){o.trigger("click",[!0])}),100)}}}}))},this.addUrlParameter=function(t,a,e,s){null!=t&&0!=t.length||(t=document.location.href);var i=t.split("?"),r="";if(i.length>1)for(var l=i[1].split("&"),c=0;c<l.length;c++){var o=l[c].split("=");s&&o[0]==a||(""==r?r="?":r+="&",r+=o[0]+"="+o[1])}return""==r?r="?":r+="&",r+=a+"="+e,i[0]+r},this.matchVariation=function(e,s){var i=!1;return t.each(a.variationData,(function(t,a){"attributes"in a&&s in a.attributes&&a.attributes[s]===e&&(i=a)})),i},this.init()};t(document).on("wc_variation_form",".variations_form",(function(t,e){new a(e)}));var e=function(a){void 0!==t.fn.wc_variation_form&&t(".variations_form",a).each((function(){t(this).wc_variation_form()}))};rey.hooks.addAction("ajaxfilters/finished",(function(t){e(t)})),rey.hooks.addAction("product/loaded",(function(t){e(t)})),rey.params.delay_js_event&&window.addEventListener(rey.params.delay_js_event,(function(t){e()}))}(jQuery);